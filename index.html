<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="manifest" href="manifest.json"> <!-- Manifest link -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DELTA Network (Airdrop Eligibility: Confirmed)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #000;
            color: #fff;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        #tapButton {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #000;
            color: #1E90FF;
            border: 2px solid #1E90FF;
            font-size: 36px;
            cursor: pointer;
            transition: transform 0.25s ease;
        }
        #tapButton:hover {
            background-color: #1E90FF;
            color: #000;
        }
        #walletButton {
            margin-top: 20px;
            background-color: #1E90FF;
            color: #fff;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 18px;
            border-radius: 5px;
        }
        #walletButton:hover {
            background-color: #00BFFF;
        }
        #wallet {
            display: none;
            width: 300px;
            height: 400px;
            background-color: #111;
            border: 2px solid #1E90FF;
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            padding: 20px;
            box-sizing: border-box;
            color: white;
            font-size: 16px;
            overflow: hidden;
        }
        #closeWallet {
            background-color: transparent;
            border: none;
            color: white;
            font-size: 24px;
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
        }
        #closeWallet:hover {
            color: #FF6347;
        }
        .walletHeader {
            font-size: 20px;
            margin-bottom: 20px;
        }
        #cryptoPrices {
            font-size: 18px;
            margin-bottom: 20px;
        }
        #deltaAmount {
            font-size: 20px;
            color: #1E90FF;
        }
        #tapCount {
            font-size: 20px;
            margin-top: 20px;
        }
        #installButton {
            background-color: #1E90FF;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 18px;
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
        }
        #installButton:hover {
            background-color: #00BFFF;
        }
    </style>
</head>
<body>

    <h1>Tap to Mine Delta</h1>
    
    <button id="tapButton" onclick="tap()">âˆ†</button>
    
    <p id="tapCount">Total Taps: 0</p>
    
    <button id="walletButton" onclick="openWallet()">Open Wallet</button>
    
    <div id="wallet">
        <button id="closeWallet" onclick="closeWallet()">X</button>
        <div class="walletHeader">Wallet</div>
        <div id="deltaAmount">Delta: 0.0000 USD</div>
        <div id="cryptoPrices">
            <p>Loading crypto prices...</p>
        </div>
    </div>

    <button id="installButton">Install App</button>

    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/worker.js') // Path to worker.js
                .then((registration) => {
                    console.log('Service Worker registered with scope:', registration.scope);
                })
                .catch((error) => {
                    console.error('Service Worker registration failed:', error);
                });
        }

        let taps = parseInt(localStorage.getItem('taps')) || 0;
        const deltaPrice = 0.001;
        let deferredPrompt;

        // Add event listener for the 'beforeinstallprompt' event to show the Install Button
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the default install prompt
            e.preventDefault();
            // Save the event for later use
            deferredPrompt = e;
            // Show the custom install button
            document.getElementById('installButton').style.display = 'block';

            document.getElementById('installButton').addEventListener('click', () => {
                // Show the native install prompt
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the A2HS prompt');
                    } else {
                        console.log('User dismissed the A2HS prompt');
                    }
                    deferredPrompt = null;
                });
            });
        });

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('tapCount').innerText = `Total Taps: ${taps}`;
            document.getElementById('deltaAmount').innerText = `Delta: ${(taps * deltaPrice).toFixed(4)} USD`;
        });

        async function getCryptoPrices() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,binancecoin,pepe,shiba-inu,the-open-network,dogecoin&vs_currencies=usd');
                if (!response.ok) throw new Error('Failed to fetch crypto prices');

                const data = await response.json();
                document.getElementById('cryptoPrices').innerHTML = `
                    <p>Bitcoin: $${data.bitcoin.usd}</p>
                    <p>Ethereum: $${data.ethereum.usd}</p>
                    <p>Binance Coin: $${data.binancecoin.usd}</p>
                    <p>Pepe Coin: $${data.pepe.usd}</p>
                    <p>Shiba Inu: $${data['shiba-inu'].usd}</p>
                    <p>TON (The Open Network): $${data['the-open-network'].usd}</p>
                    <p>Dogecoin: $${data.dogecoin.usd}</p>
                `;
            } catch (error) {
                console.error('Error fetching crypto prices:', error);
                document.getElementById('cryptoPrices').innerHTML = `<p>Error loading prices.</p>`;
            }
        }

        function tap() {
            taps += 1;
            document.getElementById('tapCount').innerText = `Total Taps: ${taps}`;
            document.getElementById('deltaAmount').innerText = `Delta: ${(taps * deltaPrice).toFixed(4)} USD`;

            const button = document.getElementById('tapButton');
            button.style.transform = 'scale(0.8)';
            setTimeout(() => button.style.transform = 'scale(1)', 250);
        }

        function openWallet() {
            document.getElementById('wallet').style.display = 'block';
            getCryptoPrices();
        }

        function closeWallet() {
            document.getElementById('wallet').style.display = 'none';
        }

        setInterval(() => {
            localStorage.setItem('taps', taps);
        }, 30);
    </script>

</body>
</html>
